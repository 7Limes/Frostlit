[gd_scene load_steps=16 format=3 uid="uid://cnivq5x3pn6cr"]

[ext_resource type="Material" uid="uid://d0mxw0twcpkls" path="res://Assets/Materials/Ice/ice.tres" id="1_q2uwy"]
[ext_resource type="PackedScene" uid="uid://1a0i72xpxodg" path="res://Player/player.tscn" id="2_q2uwy"]
[ext_resource type="ArrayMesh" uid="uid://do4uqx1m321p1" path="res://Assets/Models/lighthouse.obj" id="5_g86mt"]
[ext_resource type="Script" uid="uid://dqiqxpxds8shn" path="res://Scripts/Lighthouse/teleport_area.gd" id="7_jvpjp"]
[ext_resource type="AudioStream" uid="uid://bsnwukbh1y8dl" path="res://Assets/Audio/Door/door-open.mp3" id="8_i1fv3"]
[ext_resource type="Script" uid="uid://bjhuygaqnea2o" path="res://Scripts/General/fade_rect.gd" id="8_t871u"]
[ext_resource type="AudioStream" uid="uid://bck3t1o7ld4wu" path="res://Assets/Audio/Door/door_close.mp3" id="9_pc8c5"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_qetym"]

[sub_resource type="Sky" id="Sky_q2uwy"]
sky_material = SubResource("ProceduralSkyMaterial_qetym")

[sub_resource type="Environment" id="Environment_5e1uj"]
sky = SubResource("Sky_q2uwy")
ambient_light_source = 3
fog_enabled = true
fog_light_color = Color(0.2106368, 0.23213801, 0.26559368, 1)
fog_density = 0.1283

[sub_resource type="PlaneMesh" id="PlaneMesh_qetym"]
size = Vector2(1000, 1000)

[sub_resource type="BoxShape3D" id="BoxShape3D_q2uwy"]
size = Vector3(1000, 1, 1000)

[sub_resource type="BoxShape3D" id="BoxShape3D_e304g"]
size = Vector3(1.8314056, 2.9669495, 2.8923035)

[sub_resource type="BoxMesh" id="BoxMesh_i1fv3"]

[sub_resource type="SphereMesh" id="SphereMesh_jvpjp"]
radius = 0.1
height = 0.2

[node name="Node3D" type="Node3D"]

[node name="Player" parent="." instance=ExtResource("2_q2uwy")]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.1541648, 2.7478411, -13.782367)

[node name="DoorOpenSound" type="AudioStreamPlayer3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.1541648, -0.42030263, 10.201856)
stream = ExtResource("8_i1fv3")

[node name="DoorCloseSound" type="AudioStreamPlayer3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.1541648, -0.42029595, 10.201208)
stream = ExtResource("9_pc8c5")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_5e1uj")

[node name="Ocean" type="StaticBody3D" parent="."]
metadata/ground = "snow"

[node name="Mesh" type="MeshInstance3D" parent="Ocean"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.034121037, -0.13232398, -0.7484914)
material_override = ExtResource("1_q2uwy")
mesh = SubResource("PlaneMesh_qetym")
skeleton = NodePath("")

[node name="Collision" type="CollisionShape3D" parent="Ocean"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.62923765, 0)
shape = SubResource("BoxShape3D_q2uwy")

[node name="Island" type="CSGSphere3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -7.5372696, 0)
use_collision = true
radius = 9.833695
radial_segments = 24
rings = 8

[node name="Sections" type="Node3D" parent="."]

[node name="Section1" type="Node3D" parent="Sections"]

[node name="CSGCylinder3D" type="CSGCylinder3D" parent="Sections/Section1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 21.955662, 4.737488, -18.949688)
radius = 6.7094727
height = 22.094849

[node name="CSGBox3D" type="CSGBox3D" parent="Sections/Section1"]
transform = Transform3D(1, 0, 0, 0, 0.97953314, -0.20128308, 0, 0.20128308, 0.97953314, -1.531517, -0.25128365, -14.326071)
use_collision = true
size = Vector3(4.098633, 1, 6.7285156)
metadata/ground = "wood"

[node name="Lighthouse" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.4831586, 0)
mesh = ExtResource("5_g86mt")

[node name="EnterLighthouseArea" type="Area3D" parent="Lighthouse" node_paths=PackedStringArray("destination", "interact_sfx")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -2.9892716)
script = ExtResource("7_jvpjp")
destination = NodePath("../../LighthouseRoom/EnterPoint")
actionbar_prompt = "Press E to enter"
interact_sfx = NodePath("../../Player/DoorOpenSound")

[node name="Collision" type="CollisionShape3D" parent="Lighthouse/EnterLighthouseArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.05230713, 0.85198975, 0.3881836)
shape = SubResource("BoxShape3D_e304g")

[node name="ExitPoint" type="Node3D" parent="Lighthouse"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.06247878, 1.22493, -4.1460495)

[node name="LighthouseRoom" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 500, 0)
use_collision = true
flip_faces = true
size = Vector3(10, 5, 10)
metadata/ground = "wood"

[node name="EnterPoint" type="Node3D" parent="LighthouseRoom"]
transform = Transform3D(-4.371139e-08, 0, -1, 0, 1, 0, 1, 0, -4.371139e-08, -3.295483, -1.4455566, 0)

[node name="ExitLighthouseArea" type="Area3D" parent="LighthouseRoom" node_paths=PackedStringArray("destination", "arrive_sfx")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.798131, -1.1789856, -0.022398472)
script = ExtResource("7_jvpjp")
destination = NodePath("../../Lighthouse/ExitPoint")
actionbar_prompt = "Press E to exit"
arrive_sfx = NodePath("../../Player/DoorCloseSound")
indoor_destination = false

[node name="Collision" type="CollisionShape3D" parent="LighthouseRoom/ExitLighthouseArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.1505661, 0, 0.064468384)
shape = SubResource("BoxShape3D_e304g")

[node name="Door" type="MeshInstance3D" parent="LighthouseRoom"]
transform = Transform3D(0.38951933, 0, 0, 0, 2.5174923, 0, 0, 0, 1.7499651, -4.8288093, -1.2919312, 0)
mesh = SubResource("BoxMesh_i1fv3")

[node name="Light" type="MeshInstance3D" parent="LighthouseRoom"]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, 1, 0, -1, -4.371139e-08, 0, 2.468872, 0)
mesh = SubResource("SphereMesh_jvpjp")
skeleton = NodePath("SpotLight3D")

[node name="SpotLight3D" type="SpotLight3D" parent="LighthouseRoom/Light"]
light_color = Color(1, 0.75639063, 0.37819606, 1)
light_energy = 7.75
spot_range = 7.719363
spot_angle = 48.226097

[node name="FadeRect" type="ColorRect" parent="."]
unique_name_in_owner = true
offset_left = -38.0
offset_top = -41.0
offset_right = 1187.0
offset_bottom = 672.0
mouse_filter = 2
color = Color(0, 0, 0, 0)
script = ExtResource("8_t871u")

[connection signal="body_entered" from="Lighthouse/EnterLighthouseArea" to="Lighthouse/EnterLighthouseArea" method="_on_body_entered"]
[connection signal="body_exited" from="Lighthouse/EnterLighthouseArea" to="Lighthouse/EnterLighthouseArea" method="_on_body_exited"]
[connection signal="body_entered" from="LighthouseRoom/ExitLighthouseArea" to="LighthouseRoom/ExitLighthouseArea" method="_on_body_entered"]
[connection signal="body_exited" from="LighthouseRoom/ExitLighthouseArea" to="LighthouseRoom/ExitLighthouseArea" method="_on_body_exited"]
